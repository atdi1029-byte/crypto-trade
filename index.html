<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a1628">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>Crypto Trade Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-deep: #0a1628;
            --bg-dark: #0f1d30;
            --bg-card: #142236;
            --bg-card-hover: #1a2d45;
            --border: #1e3a5f;
            --border-light: #2a4a70;
            --text: #c8d8e8;
            --text-dim: #6a8aaa;
            --text-bright: #e8f0f8;
            --accent: #4a9eff;
            --accent-glow: #6ab4ff;
            --accent-deep: #2a7edf;
            --green-candle: #26a69a;
            --green-bright: #4dd0c4;
            --green-dim: #1a3a36;
            --red-candle: #ef5350;
            --red-bright: #ff6b6b;
            --red-dim: #3a1a1a;
        }

        body {
            font-family: 'Space Mono', 'Noto Serif JP', monospace;
            background: var(--bg-deep);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* ============ MAIN CONTENT ============ */
        .content {
            position: relative;
            z-index: 1;
            padding: 1.5rem 2rem 4rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ============ HEADER ============ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
            border-image: linear-gradient(90deg, transparent, var(--accent-deep), var(--border), transparent) 1;
        }
        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .header-logo {
            width: 120px;
            height: 120px;
            border-radius: 18px;
            border: 2px solid var(--accent-deep);
            box-shadow: 0 0 25px #4a9eff44;
        }
        .header h1 {
            font-family: 'Noto Serif JP', serif;
            font-size: 3rem;
            font-weight: 900;
            color: var(--text-bright);
            letter-spacing: 3px;
            line-height: 1;
        }
        .header h1 span {
            font-family: 'Space Mono', monospace;
            font-size: 2.8rem;
            font-weight: 700;
            color: var(--accent);
            text-shadow: 0 0 25px #4a9eff44, 0 3px 6px #00000066;
            letter-spacing: 4px;
            display: block;
            margin-top: 4px;
        }
        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.75rem;
            color: var(--text-dim);
        }
        .refresh-btn {
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--accent-glow);
            padding: 6px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.2s;
        }
        .refresh-btn:hover {
            background: var(--border);
            border-color: var(--accent-deep);
            box-shadow: 0 0 10px #4a9eff22;
        }
        .status-dot {
            width: 8px; height: 8px;
            border-radius: 50%;
            background: var(--green-candle);
            display: inline-block;
            margin-right: 4px;
            box-shadow: 0 0 6px #26a69a66;
        }
        .status-dot.error { background: var(--red-candle); box-shadow: 0 0 6px #ef535066; }
        .status-dot.loading { background: var(--accent); animation: pulse 1s infinite; box-shadow: 0 0 6px #4a9eff66; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

        /* ============ SECTION HEADERS ============ */
        .section-header {
            font-family: 'Noto Serif JP', serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-bright);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding-left: 12px;
            border-left: 3px solid var(--accent);
        }
        .section-header .count {
            background: var(--accent-deep);
            color: var(--text-bright);
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: 700;
        }

        /* ============ QUOTE BANNER ============ */
        .quote-banner {
            text-align: center;
            padding: 0.8rem 2rem;
            margin-bottom: 1.25rem;
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            border-image: linear-gradient(90deg, transparent, var(--border-light), transparent) 1;
            animation: fadeIn 1s ease;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .quote-text {
            font-family: 'Noto Serif JP', serif;
            font-size: 0.85rem;
            font-style: italic;
            color: var(--text-bright);
            opacity: 0.7;
            line-height: 1.5;
        }
        .quote-author {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            color: var(--accent);
            letter-spacing: 1.5px;
            text-transform: uppercase;
            margin-top: 0.3rem;
            opacity: 0.6;
        }

        /* ============ QUICK STATS BAR ============ */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-deep), transparent);
        }
        .stat-value {
            font-family: 'Space Mono', monospace;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-bright);
            line-height: 1.2;
        }
        .stat-value.green { color: var(--green-bright); text-shadow: 0 0 10px #26a69a33; }
        .stat-value.red { color: var(--red-bright); text-shadow: 0 0 10px #ef535033; }
        .stat-label {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 6px;
        }

        /* ============ TOP PICKS ============ */
        .top-picks-section { margin-bottom: 1.5rem; }
        .top-picks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 0.75rem;
        }
        .top-pick-card {
            background: var(--bg-card);
            border: 1px solid var(--accent-deep);
            border-radius: 6px;
            padding: 1rem;
            position: relative;
            overflow: hidden;
            transition: all 0.25s;
        }
        .top-pick-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-deep), var(--accent-glow), var(--accent-deep));
        }
        .top-pick-card:hover {
            border-color: var(--accent);
            box-shadow: 0 4px 20px #0008, 0 0 20px #4a9eff15;
            transform: translateY(-2px);
        }
        .top-pick-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.6rem;
        }
        .top-pick-symbol {
            font-family: 'Noto Serif JP', serif;
            font-size: 1.3rem;
            font-weight: 900;
            color: var(--text-bright);
            letter-spacing: 1px;
        }
        .top-pick-score {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            font-weight: 700;
            padding: 3px 10px;
            border-radius: 3px;
            background: var(--accent-deep);
            color: var(--accent-glow);
            border: 1px solid var(--accent);
        }
        .top-pick-direction {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 2px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .top-pick-direction.long { background: var(--green-dim); color: var(--green-bright); }
        .top-pick-direction.short { background: var(--red-dim); color: var(--red-bright); }
        .top-pick-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.3rem 1rem;
            font-size: 0.7rem;
            margin-top: 0.5rem;
        }
        .top-pick-details dt { color: var(--text-dim); font-size: 0.6rem; }
        .top-pick-details dd { color: var(--text); font-weight: 700; text-align: right; }
        .top-pick-actions {
            display: flex;
            gap: 0.4rem;
            margin-top: 0.6rem;
            padding-top: 0.6rem;
            border-top: 1px solid var(--border);
        }
        .no-picks {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 1.5rem;
            text-align: center;
            color: var(--text-dim);
            font-size: 0.8rem;
            font-style: italic;
        }

        /* ============ ACTION NEEDED ============ */
        .action-section { margin-bottom: 1.5rem; }
        .action-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .action-item {
            background: var(--bg-card);
            border: 1px solid var(--accent-deep);
            border-left: 4px solid var(--accent);
            border-radius: 4px;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .action-item .ticker-badge {
            background: var(--accent);
            color: var(--bg-deep);
            font-weight: 700;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 3px;
            margin-right: 0.75rem;
            letter-spacing: 1px;
        }
        .action-item .message { font-size: 0.8rem; color: var(--text-bright); }
        .action-item .meta { font-size: 0.7rem; color: var(--text-dim); }
        .action-buttons {
            display: flex;
            gap: 0.4rem;
            margin-top: 0.5rem;
        }
        .action-btn {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            font-weight: 700;
            padding: 5px 12px;
            border-radius: 3px;
            border: 1px solid var(--border);
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.2s;
        }
        .action-btn:hover { transform: translateY(-1px); }
        .action-btn.entered {
            background: var(--green-dim);
            color: var(--green-bright);
            border-color: var(--green-candle);
        }
        .action-btn.entered:hover { background: var(--green-candle); color: var(--text-bright); }
        .action-btn.skipped {
            background: var(--bg-dark);
            color: var(--text-dim);
            border-color: var(--border);
        }
        .action-btn.skipped:hover { background: var(--border); color: var(--text); }
        .action-btn.won {
            background: var(--green-dim);
            color: var(--green-bright);
            border-color: var(--green-candle);
        }
        .action-btn.won:hover { background: var(--green-candle); color: var(--text-bright); }
        .action-btn.lost {
            background: var(--red-dim);
            color: var(--red-bright);
            border-color: var(--red-candle);
        }
        .action-btn.lost:hover { background: var(--red-candle); color: var(--text-bright); }
        .action-btn.open-pos {
            background: #4a9eff22;
            color: var(--accent-glow);
            border-color: #4a9eff44;
        }
        .action-btn.open-pos:hover { background: #4a9eff44; color: var(--text-bright); }
        .action-btn:disabled {
            opacity: 0.4;
            cursor: default;
            transform: none;
        }
        .entry-input {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            color: var(--text-bright);
            padding: 4px 8px;
            border-radius: 3px;
            width: 60px;
            text-align: center;
        }
        .entry-input::placeholder { color: var(--text-dim); }
        .entry-input:focus { outline: none; border-color: var(--accent); }
        .no-actions {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 1.5rem;
            text-align: center;
            color: var(--green-candle);
            font-size: 0.8rem;
        }

        /* ============ TICKER GRID ============ */
        .ticker-search-bar {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            align-items: center;
        }
        .ticker-search-bar input {
            flex: 1;
            max-width: 300px;
            padding: 0.4rem 0.75rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-bright);
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
        }
        .ticker-search-bar input::placeholder { color: var(--text-dim); }
        .ticker-search-bar input:focus {
            outline: none;
            border-color: var(--accent);
        }
        .ticker-search-bar button {
            padding: 0.4rem 0.75rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-dim);
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .ticker-search-bar button:hover { border-color: var(--accent); color: var(--text-bright); }
        .ticker-search-bar button.active {
            background: var(--accent-deep);
            border-color: var(--accent);
            color: var(--text-bright);
        }
        .ticker-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        .ticker-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem;
            transition: all 0.25s;
            position: relative;
            overflow: hidden;
        }
        .ticker-card::after {
            content: '';
            position: absolute;
            bottom: 0; left: 0; right: 0;
            height: 40px;
            background: linear-gradient(transparent, #0a162808);
            pointer-events: none;
        }
        .ticker-card:hover {
            border-color: var(--accent-deep);
            box-shadow: 0 4px 20px #0008, 0 0 15px #4a9eff11;
            transform: translateY(-2px);
        }
        .ticker-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        .ticker-name {
            font-family: 'Noto Serif JP', serif;
            font-size: 1.2rem;
            font-weight: 900;
            color: var(--text-bright);
            letter-spacing: 1px;
        }
        .ticker-direction {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            font-weight: 700;
            padding: 3px 8px;
            border-radius: 3px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .ticker-direction.long { background: var(--green-dim); color: var(--green-bright); border: 1px solid var(--green-candle); }
        .ticker-direction.short { background: var(--red-dim); color: var(--red-bright); border: 1px solid var(--red-candle); }
        .ticker-direction.idle { background: var(--bg-dark); color: var(--text-dim); border: 1px solid var(--border); }

        .ticker-detail {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.35rem 1rem;
            font-size: 0.75rem;
        }
        .ticker-detail dt { color: var(--text-dim); font-size: 0.65rem; letter-spacing: 0.5px; }
        .ticker-detail dd { color: var(--text); font-weight: 700; text-align: right; }
        .ticker-detail dd.green { color: var(--green-bright); }
        .ticker-detail dd.red { color: var(--red-bright); }
        .ticker-last-signal {
            margin-top: 0.6rem;
            padding-top: 0.6rem;
            border-top: 1px solid var(--border);
            font-size: 0.65rem;
            color: var(--text-dim);
            font-style: italic;
        }
        .ticker-links {
            display: flex;
            gap: 0.4rem;
            margin-top: 0.6rem;
            padding-top: 0.6rem;
            border-top: 1px solid var(--border);
        }
        .ticker-link {
            font-family: 'Space Mono', monospace;
            font-size: 0.5rem;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 3px;
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.2s;
            border: 1px solid var(--border);
            background: var(--bg-dark);
            color: var(--text-dim);
        }
        .ticker-link:hover {
            border-color: var(--accent-deep);
            color: var(--text-bright);
            background: var(--border);
        }
        .ticker-link.tv { color: #2196F3; border-color: #2196F322; }
        .ticker-link.tv:hover { background: #2196F322; border-color: #2196F3; color: #64B5F6; }
        .ticker-link.bx { color: var(--accent-glow); border-color: #4a9eff22; }
        .ticker-link.bx:hover { background: #4a9eff22; border-color: var(--accent); color: var(--accent-glow); }

        /* ============ ALL SIGNALS TABLE ============ */
        .signals-section { margin-bottom: 1.5rem; }
        .section-box {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
        }
        .signals-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.75rem;
        }
        .signals-table th {
            text-align: left;
            padding: 0.5rem 0.5rem;
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid var(--border);
            white-space: nowrap;
        }
        .signals-table td {
            padding: 0.45rem 0.5rem;
            border-bottom: 1px solid #14223644;
            white-space: nowrap;
        }
        .signals-table tr:hover td { background: #1a2d4544; }
        .signal-badge {
            font-family: 'Space Mono', monospace;
            font-size: 0.55rem;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 2px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .signal-badge.long { background: var(--green-dim); color: var(--green-bright); }
        .signal-badge.short { background: var(--red-dim); color: var(--red-bright); }
        .score-badge {
            font-family: 'Space Mono', monospace;
            font-size: 0.6rem;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 3px;
            display: inline-block;
        }
        .score-badge.high { background: #26a69a33; color: var(--green-bright); border: 1px solid var(--green-candle); }
        .score-badge.mid { background: #f9a82533; color: #f9c846; border: 1px solid #f9a825; }
        .score-badge.low { background: #ef535033; color: var(--red-bright); border: 1px solid var(--red-candle); }

        /* ============ PERFORMANCE GRID ============ */
        .bottom-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .perf-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.6rem;
        }
        .perf-item {
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 0.75rem;
            text-align: center;
        }
        .perf-item .perf-val {
            font-family: 'Space Mono', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-bright);
        }
        .perf-item .perf-label {
            font-size: 0.55rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 3px;
        }

        /* ============ LOADING / ERROR ============ */
        .loading-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: #0a1628ee;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        .loading-overlay.hidden { display: none; }
        .spinner {
            width: 40px; height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-bottom: 1rem;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .error-banner {
            background: #ef535018;
            border: 1px solid var(--red-candle);
            border-radius: 4px;
            padding: 0.75rem 1rem;
            margin-bottom: 1rem;
            color: var(--red-bright);
            font-size: 0.8rem;
            display: none;
        }
        .error-banner.show { display: block; }

        /* ============ FOOTER ============ */
        .footer {
            text-align: center;
            padding: 2rem 0 1rem;
            font-size: 0.6rem;
            color: var(--text-dim);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        /* ============ RESPONSIVE ============ */
        @media (max-width: 768px) {
            .content { padding: 1rem 1rem 3rem; }
            .header { flex-direction: column; gap: 1rem; text-align: center; }
            .header-left { flex-direction: column; }
            .header-logo { width: 80px; height: 80px; }
            .header h1 { font-size: 2rem; }
            .header h1 span { font-size: 1.8rem; }
            .ticker-grid { grid-template-columns: 1fr; }
            .top-picks-grid { grid-template-columns: 1fr; }
            .stats-bar { grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); }
        }
    </style>
</head>
<body>

<!-- ============ LOADING ============ -->
<div class="loading-overlay" id="loading">
    <div class="spinner"></div>
    <div style="color: var(--text-dim); font-size: 0.8rem; letter-spacing: 2px; text-transform: uppercase;">Loading dashboard...</div>
</div>

<!-- ============ MAIN CONTENT ============ -->
<div class="content">
    <div class="error-banner" id="errorBanner"></div>

    <div class="header">
        <div class="header-left">
            <img src="logo.png" alt="Crypto" class="header-logo">
            <div>
                <h1>トレード<span>TRADE!</span></h1>
            </div>
        </div>
        <div class="header-right">
            <span><span class="status-dot loading" id="statusDot"></span><span id="statusText">Connecting...</span></span>
            <span id="lastUpdate"></span>
            <button class="refresh-btn" onclick="fetchData()">Refresh</button>
        </div>
    </div>

    <!-- Quote Banner -->
    <div class="quote-banner" id="quoteBanner">
        <div class="quote-text" id="quoteText"></div>
        <div class="quote-author" id="quoteAuthor"></div>
    </div>

    <!-- Quick Stats Bar -->
    <div class="stats-bar" id="statsBar">
        <div class="stat-card">
            <div class="stat-value" id="statOpen">-</div>
            <div class="stat-label">Open Positions</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="statWinRate">-</div>
            <div class="stat-label">Win Rate</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="statTotal">-</div>
            <div class="stat-label">Total Trades</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="statToday">-</div>
            <div class="stat-label">Today's Signals</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="statStreak">-</div>
            <div class="stat-label">Current Streak</div>
        </div>
    </div>

    <!-- Top Picks -->
    <div class="top-picks-section" id="topPicksSection">
        <div class="section-header">Top Picks <span class="count" id="topPicksCount">0</span></div>
        <div class="top-picks-grid" id="topPicksGrid"></div>
    </div>

    <!-- Action Needed -->
    <div class="action-section" id="actionSection">
        <div class="section-header">Action Needed <span class="count" id="actionCount">0</span></div>
        <div class="action-list" id="actionList"></div>
    </div>

    <!-- Ticker Grid -->
    <div class="section-header">Tickers <span class="count" id="tickerCount">0</span></div>
    <div class="ticker-search-bar">
        <input type="text" id="tickerSearch" placeholder="Search tickers..." oninput="filterTickers()">
        <button id="tickerShowAll" onclick="toggleShowAll()">Show All</button>
    </div>
    <div class="ticker-grid" id="tickerGrid"></div>

    <!-- All Signals Table -->
    <div class="signals-section">
        <div class="section-header">All Signals <span class="count" id="signalCount">0</span></div>
        <div class="section-box">
            <table class="signals-table" id="signalsTable">
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>Symbol</th>
                        <th>Direction</th>
                        <th>Entry</th>
                        <th>SL</th>
                        <th>TP1</th>
                        <th>Score</th>
                        <th>MACD</th>
                        <th>Volume</th>
                        <th>RSI</th>
                    </tr>
                </thead>
                <tbody id="signalsBody"></tbody>
            </table>
        </div>
    </div>

    <!-- Performance Summary -->
    <div class="bottom-grid">
        <div>
            <div class="section-header">Performance Summary</div>
            <div class="section-box">
                <div class="perf-grid" id="perfGrid"></div>
            </div>
        </div>
    </div>

    <div class="footer">Crypto Trade Dashboard</div>
</div>

<script>
    // ====== CONFIG ======
    const API_URL = 'https://script.google.com/macros/s/AKfycbywWcasm7wwI14tUc64XpTscePJlgiU3Q7sZ4uY-TmqjqVZzuxJOhf6T8fO2ZpSaKwV/exec?action=dashboard';
    const POST_URL = 'https://script.google.com/macros/s/AKfycbywWcasm7wwI14tUc64XpTscePJlgiU3Q7sZ4uY-TmqjqVZzuxJOhf6T8fO2ZpSaKwV/exec';
    const REFRESH_INTERVAL = 60000;

    let refreshTimer = null;
    let allTickers = [];
    let allSignals = [];
    let showAllTickers = false;
    const TICKER_LIMIT = 8;

    // ====== SCORING LOGIC ======
    function scoreSignal(s) {
        let score = 0;
        if (s.macd === 'rising' || s.macd === 'falling') score += 2;
        if (Number(s.cross) >= 0 && Number(s.cross) <= 5) score += 2;
        if (s.in_zone === true || s.in_zone === 'true') score += 1;
        if (s.volume === 'above') score += 1;
        return score;
    }

    function getScoreClass(score) {
        if (score >= 5) return 'high';
        if (score >= 3) return 'mid';
        return 'low';
    }

    // ====== FETCH DATA ======
    async function fetchData() {
        const dot = document.getElementById('statusDot');
        const statusText = document.getElementById('statusText');
        dot.className = 'status-dot loading';
        statusText.textContent = 'Fetching...';

        try {
            const resp = await fetch(API_URL);
            if (!resp.ok) throw new Error('HTTP ' + resp.status);
            const data = await resp.json();

            if (data.status !== 'ok') throw new Error(data.message || 'Bad response');

            renderDashboard(data);

            dot.className = 'status-dot';
            statusText.textContent = 'Live';
            document.getElementById('lastUpdate').textContent = 'Updated ' + new Date().toLocaleTimeString();
            document.getElementById('errorBanner').className = 'error-banner';
            document.getElementById('loading').className = 'loading-overlay hidden';
        } catch (err) {
            renderDashboard(EMPTY_DATA);
            dot.className = 'status-dot';
            statusText.textContent = 'Preview';
            document.getElementById('lastUpdate').textContent = 'No data';
            document.getElementById('errorBanner').className = 'error-banner';
            document.getElementById('loading').className = 'loading-overlay hidden';
        }

        if (refreshTimer) clearTimeout(refreshTimer);
        refreshTimer = setTimeout(fetchData, REFRESH_INTERVAL);
    }

    // ====== RENDER ======
    function renderDashboard(data) {
        const { tickers, recentSignals, actionNeeded, stats } = data;

        // Score all signals
        const scoredSignals = (recentSignals || []).map(s => {
            s._score = scoreSignal(s);
            return s;
        });
        allSignals = scoredSignals;

        // --- Quick Stats ---
        document.getElementById('statOpen').textContent = stats.openPositions || 0;

        const wrEl = document.getElementById('statWinRate');
        wrEl.textContent = stats.winRate || '0%';
        wrEl.className = 'stat-value' + (parseFloat(stats.winRate) >= 50 ? ' green' : parseFloat(stats.winRate) > 0 ? ' red' : '');

        document.getElementById('statTotal').textContent = stats.totalTrades || 0;
        document.getElementById('statToday').textContent = stats.todaySignals || 0;

        const streakEl = document.getElementById('statStreak');
        const streakStr = stats.currentStreak || '-';
        streakEl.textContent = streakStr;
        streakEl.className = 'stat-value' + (streakStr.includes('W') ? ' green' : streakStr.includes('L') ? ' red' : '');

        // --- Top Picks (score >= 5) ---
        renderTopPicks(scoredSignals);

        // --- Action Needed ---
        renderActions(actionNeeded || []);

        // --- Ticker Grid ---
        allTickers = tickers || [];
        document.getElementById('tickerCount').textContent = allTickers.length;
        renderTickerGrid();

        // --- All Signals Table ---
        renderSignalsTable(scoredSignals);

        // --- Performance Summary ---
        renderPerformance(stats);
    }

    // ====== TOP PICKS ======
    function renderTopPicks(signals) {
        const grid = document.getElementById('topPicksGrid');
        const countEl = document.getElementById('topPicksCount');
        const topPicks = signals.filter(s => s._score >= 5);
        countEl.textContent = topPicks.length;

        if (topPicks.length === 0) {
            grid.innerHTML = '<div class="no-picks">No high-conviction signals right now</div>';
            return;
        }

        grid.innerHTML = topPicks.map((s, i) => {
            const dir = (s.direction || s.signal || '').toLowerCase();
            const dirClass = dir === 'short' ? 'short' : 'long';
            const entry = Number(s.entry || s.price || 0);
            const sl = Number(s.sl || 0);
            const tp1 = Number(s.tp1 || 0);
            const rr = sl > 0 && entry > 0 ? Math.abs((tp1 - entry) / (entry - sl)).toFixed(2) : '-';
            const pickId = 'pick-' + i;

            return `
                <div class="top-pick-card" id="${pickId}">
                    <div class="top-pick-header">
                        <div style="display:flex;align-items:center;gap:0.5rem">
                            <span class="top-pick-symbol">${esc(s.symbol || s.ticker || '-')}</span>
                            <span class="top-pick-direction ${dirClass}">${dirClass.toUpperCase()}</span>
                        </div>
                        <span class="top-pick-score">${s._score}/7</span>
                    </div>
                    <dl class="top-pick-details">
                        <dt>Entry</dt><dd>${entry ? '$' + entry.toFixed(2) : '-'}</dd>
                        <dt>Stop Loss</dt><dd class="red">${sl ? '$' + sl.toFixed(2) : '-'}</dd>
                        <dt>TP1</dt><dd class="green">${tp1 ? '$' + tp1.toFixed(2) : '-'}</dd>
                        <dt>R:R</dt><dd>${rr}</dd>
                    </dl>
                    <div class="top-pick-actions">
                        <button class="action-btn entered" onclick="markPickAction('${esc(s.symbol || s.ticker)}','${esc(s.direction || s.signal)}',${entry},'Entered','${pickId}')">Entered</button>
                        <button class="action-btn skipped" onclick="markPickAction('${esc(s.symbol || s.ticker)}','${esc(s.direction || s.signal)}',${entry},'Skipped','${pickId}')">Skipped</button>
                    </div>
                </div>
            `;
        }).join('');
    }

    // ====== ACTION NEEDED ======
    function renderActions(actionNeeded) {
        const actionList = document.getElementById('actionList');
        const actionCount = document.getElementById('actionCount');
        actionCount.textContent = actionNeeded.length;

        if (actionNeeded.length === 0) {
            actionList.innerHTML = '<div class="no-actions">All caught up - no actions needed</div>';
            return;
        }

        actionList.innerHTML = actionNeeded.map((a, i) => {
            const id = 'action-' + i;
            if (a.type === 'mark_action') {
                return `
                    <div class="action-item" id="${id}">
                        <div>
                            <div><span class="ticker-badge">${esc(a.ticker)}</span><span class="message">${esc(a.message)}</span></div>
                            <div class="action-buttons">
                                <input type="text" class="entry-input" placeholder="Size $" id="${id}-size">
                                <button class="action-btn entered" onclick="markAction('${esc(a.ticker)}','${esc(a.signal)}',${a.price},'Entered','${id}')">Entered</button>
                                <button class="action-btn skipped" onclick="markAction('${esc(a.ticker)}','${esc(a.signal)}',${a.price},'Skipped','${id}')">Skipped</button>
                            </div>
                        </div>
                        <div class="meta">${esc((a.signal || '').toUpperCase())} @ $${a.price}${a.timestamp ? ' &middot; ' + esc(a.timestamp) : ''}</div>
                    </div>`;
            } else {
                return `
                    <div class="action-item" id="${id}">
                        <div>
                            <div><span class="ticker-badge">${esc(a.ticker)}</span><span class="message">${esc(a.message)}</span></div>
                            <div class="action-buttons">
                                <input type="text" class="entry-input" placeholder="Profit $" id="${id}-profit">
                                <button class="action-btn won" onclick="markOutcome('${esc(a.ticker)}','${esc(a.signal)}',${a.price},'Won','${id}')">Won</button>
                                <button class="action-btn lost" onclick="markOutcome('${esc(a.ticker)}','${esc(a.signal)}',${a.price},'Lost','${id}')">Lost</button>
                                <button class="action-btn open-pos" onclick="markOutcome('${esc(a.ticker)}','${esc(a.signal)}',${a.price},'Open','${id}')">Open</button>
                            </div>
                        </div>
                        <div class="meta">${esc((a.signal || '').toUpperCase())} @ $${a.price}${a.timestamp ? ' &middot; ' + esc(a.timestamp) : ''}</div>
                    </div>`;
            }
        }).join('');
    }

    // ====== SIGNALS TABLE ======
    function renderSignalsTable(signals) {
        document.getElementById('signalCount').textContent = signals.length;
        const tbody = document.getElementById('signalsBody');

        tbody.innerHTML = signals.map(s => {
            const dir = (s.direction || s.signal || '').toLowerCase();
            const dirClass = dir === 'short' ? 'short' : 'long';
            const scoreClass = getScoreClass(s._score);
            const entry = Number(s.entry || s.price || 0);
            const sl = Number(s.sl || 0);
            const tp1 = Number(s.tp1 || 0);

            return `
                <tr>
                    <td>${esc(s.timestamp || '-')}</td>
                    <td style="font-weight:700;color:var(--text-bright)">${esc(s.symbol || s.ticker || '-')}</td>
                    <td><span class="signal-badge ${dirClass}">${dirClass.toUpperCase()}</span></td>
                    <td>${entry ? '$' + entry.toFixed(2) : '-'}</td>
                    <td>${sl ? '$' + sl.toFixed(2) : '-'}</td>
                    <td>${tp1 ? '$' + tp1.toFixed(2) : '-'}</td>
                    <td><span class="score-badge ${scoreClass}">${s._score}/7</span></td>
                    <td>${esc(s.macd || '-')}</td>
                    <td>${esc(s.volume || '-')}</td>
                    <td>${s.rsi != null ? Number(s.rsi).toFixed(1) : '-'}</td>
                </tr>
            `;
        }).join('');
    }

    // ====== PERFORMANCE ======
    function renderPerformance(stats) {
        const perfGrid = document.getElementById('perfGrid');

        // Calculate win rate by score range from available data
        const wrByScore = stats.winRateByScore || {};

        perfGrid.innerHTML = `
            <div class="perf-item">
                <div class="perf-val">${stats.totalTrades || 0}</div>
                <div class="perf-label">Total Trades</div>
            </div>
            <div class="perf-item">
                <div class="perf-val" style="color:${parseFloat(stats.winRate) >= 50 ? 'var(--green-bright)' : 'var(--red-bright)'}">${stats.winRate || '0%'}</div>
                <div class="perf-label">Win Rate</div>
            </div>
            <div class="perf-item">
                <div class="perf-val" style="color:var(--green-bright)">${stats.bestTicker || '-'}</div>
                <div class="perf-label">Best Ticker</div>
            </div>
            <div class="perf-item">
                <div class="perf-val" style="color:var(--red-bright)">${stats.worstTicker || '-'}</div>
                <div class="perf-label">Worst Ticker</div>
            </div>
            <div class="perf-item">
                <div class="perf-val" style="color:var(--green-bright)">${wrByScore.high || '-'}</div>
                <div class="perf-label">WR Score 5-7</div>
            </div>
            <div class="perf-item">
                <div class="perf-val" style="color:#f9c846">${wrByScore.mid || '-'}</div>
                <div class="perf-label">WR Score 3-4</div>
            </div>
            <div class="perf-item">
                <div class="perf-val" style="color:var(--red-bright)">${wrByScore.low || '-'}</div>
                <div class="perf-label">WR Score 0-2</div>
            </div>
            <div class="perf-item">
                <div class="perf-val">${stats.bestWinStreak || 0}W</div>
                <div class="perf-label">Best Win Streak</div>
            </div>
        `;
    }

    // ====== TICKER GRID ======
    function renderTickerCard(t, i) {
        const dir = (t.lastDirection || t.lastSignal || 'idle').toLowerCase();
        const dirClass = dir === 'short' ? 'short' : dir === 'long' ? 'long' : 'idle';
        const wrClass = (parseFloat(t.winRate) || 0) >= 50 ? 'green' : (parseFloat(t.winRate) || 0) > 0 ? 'red' : '';
        const tid = 'ticker-' + i;

        return `
            <div class="ticker-card" id="${tid}">
                <div class="ticker-card-header">
                    <div style="display:flex;align-items:center;gap:0.5rem">
                        <span class="ticker-name">${esc(t.ticker)}</span>
                        <span class="ticker-direction ${dirClass}">${dirClass.toUpperCase()}</span>
                    </div>
                </div>
                <dl class="ticker-detail">
                    <dt>Win Rate</dt><dd class="${wrClass}">${t.winRate || '0%'}</dd>
                    <dt>Total Trades</dt><dd>${t.totalTrades || 0}</dd>
                    <dt>Last Signal</dt><dd>${esc((t.lastSignal || '-').toUpperCase())}</dd>
                    <dt>Direction</dt><dd>${esc((t.lastDirection || '-').toUpperCase())}</dd>
                    <dt>Avg R:R</dt><dd>${t.avgRR ? Number(t.avgRR).toFixed(2) : '-'}</dd>
                </dl>
                <div class="ticker-last-signal">${t.lastTimestamp ? 'Last: ' + esc(t.lastTimestamp) : 'No signals yet'}</div>
                <div class="ticker-links">
                    <a class="ticker-link tv" href="${getTickerLink(t.ticker, 'tv')}" target="_blank">TradingView</a>
                    <a class="ticker-link bx" href="${getTickerLink(t.ticker, 'bx')}" target="_blank">Bitunix</a>
                    <button class="ticker-link" onclick="copyTicker('${esc(t.ticker)}')" title="Copy ticker">&#128203;</button>
                    <button class="ticker-link" onclick="editLinks('${esc(t.ticker)}')" title="Edit links">&#9998;</button>
                </div>
            </div>
        `;
    }

    function renderTickerGrid(filtered) {
        const grid = document.getElementById('tickerGrid');
        const btn = document.getElementById('tickerShowAll');
        const search = document.getElementById('tickerSearch').value.trim().toUpperCase();
        let tickers = filtered || allTickers;

        if (search) {
            tickers = allTickers.filter(t => t.ticker.toUpperCase().includes(search));
            btn.textContent = `${tickers.length} match${tickers.length !== 1 ? 'es' : ''}`;
            btn.classList.remove('active');
        } else if (!showAllTickers && tickers.length > TICKER_LIMIT) {
            tickers = tickers.slice(0, TICKER_LIMIT);
            btn.textContent = `Show All (${allTickers.length})`;
            btn.classList.remove('active');
        } else {
            btn.textContent = 'Show Recent';
            btn.classList.add('active');
        }

        grid.innerHTML = tickers.map((t, i) => renderTickerCard(t, i)).join('');
    }

    function filterTickers() {
        showAllTickers = false;
        renderTickerGrid();
    }

    function toggleShowAll() {
        const search = document.getElementById('tickerSearch');
        if (search.value.trim()) {
            search.value = '';
        }
        showAllTickers = !showAllTickers;
        renderTickerGrid();
    }

    // ====== HELPERS ======
    function esc(str) {
        const d = document.createElement('div');
        d.textContent = str || '';
        return d.innerHTML;
    }

    // ====== TICKER LINKS ======
    const TV_EXCHANGE_MAP = {
        '0G':'BINANCE','1000CAT':'BINANCE','1INCH':'BINANCE','2Z':'BINANCE','4':'BINANCE',
        'A':'OKX','A2Z':'BINANCE','AAVE':'BINANCE','ACE':'BINANCE','ACH':'BINANCE',
        'ACT':'BINANCE','ACU':'BINANCE','ACX':'COINBASE','ADA':'BINANCE','AERGO':'OKX',
        'AERO':'COINBASE','AEVO':'BINANCE','AGLD':'OKX','AI':'HTX','AIA':'MEXC',
        'AIN':'BINANCE','AIO':'BINANCE','AIOT':'BINANCE','AIOZ':'BYBIT','AIXBT':'BINANCE',
        'AKE':'KRAKEN','AKT':'KRAKEN','ALCH':'KRAKEN','ALEO':'GATE','ALGO':'BINANCE',
        'ALICE':'BINANCE','ALLO':'BINANCE','ALPINE':'BINGX','ALT':'BINANCE','AMP':'COINBASE',
        'ANIME':'BINANCE','ANKR':'CAPITALCOM','APE':'BINANCE','APEX':'BYBIT','API3':'BINANCE',
        'APR':'BINANCE','APT':'COINBASE','AR':'BINANCE','ARB':'BINANCE','ARIA':'BYBIT',
        'ARK':'BINANCE','ARKM':'BINANCE','ARPA':'BINANCE','ASR':'BINANCE','ASTER':'BINANCE',
        'ASTR':'BINANCE','AT':'OKX','ATH':'COINBASE','ATOM':'BINANCE','AUCTION':'BINANCE',
        'AVA':'BINANCE','AVAAI':'BINANCE','AVAX':'BINANCE','AVNT':'BINANCE','AWE':'BINANCE',
        'AXL':'BINANCE','AXS':'BINANCE','B':'BINANCE','B2':'KRAKEN','B3':'BINANCE',
        'BABY':'OKX','BAN':'BINANCE','BANANA':'BINANCE','BANANAS31':'BINANCE','BAND':'BINANCE',
        'BANK':'BINANCE','BARD':'BINANCE','BAS':'BINANCE','BAT':'KRAKEN','BB':'BINANCE',
        'BCH':'BINANCE','BDXN':'BYBIT','BEAMX':'BINANCE','BEAT':'BINANCE','BERA':'BINANCE',
        'BIANRENSHENG':'BINANCE','BICO':'BINANCE','BIGTIME':'BINANCE','BIO':'BINANCE',
        'BLESS':'BINGX','BLUAI':'BINANCE','BLUR':'BINANCE','BMT':'BINANCE','BNB':'BINANCE',
        'BNT':'BINANCE','BOBBOB':'COINBASE','BOME':'BINANCE','BONK':'BINANCE','BR':'BINANCE',
        'BRETT':'BYBIT','BREV':'OKX','BROCCOLI714':'BINANCE','BSV':'MEXC','BTC':'OKX',
        'BTR':'BINANCE','BTT':'KRAKEN','C':'BINANCE','C98':'BINANCE','CAKE':'BINANCE',
        'CARV':'KRAKEN','CATI':'COINBASE','CC':'KUCOIN','CELO':'BINANCE','CELR':'CAPITALCOM',
        'CETUS':'BINANCE','CFX':'BINANCE','CGPT':'BINANCE','CHEEMS':'BITGET','CHESS':'BINANCE',
        'CHILLGUY':'BINANCE','CHR':'BINANCE','CHZ':'GEMINI','CKB':'BINANCE','CLANKER':'BYBIT',
        'CLO':'BINANCE','COAI':'MEXC','COLLECT':'BINANCE','COMMON':'BITUNIX','COMP':'COINBASE',
        'COOKIE':'COINBASE','CORE':'OKX','COS':'BINANCE','COTI':'BINANCE','COW':'COINBASE',
        'CRO':'COINBASE','CROSS':'BINANCE','CRV':'BINANCE','CSPR':'BYBIT','CTC':'BYBIT',
        'CTK':'BINANCE','CTSI':'CAPITALCOM','CUDIS':'MEXC','CVC':'CAPITALCOM','CVX':'BINANCE',
        'CYBER':'BINANCE','CYS':'MEXC','DASH':'BINANCE','DBR':'BYBIT','DCR':'BINANCE',
        'DEEP':'KRAKEN','DEGO':'BINANCE','DENT':'BINANCE','DEXE':'BINANCE','DF':'BINANCE',
        'DGB':'BINANCE','DIA':'COINBASE','DN':'MEXC','DOG':'GATE','DOGE':'BINANCE',
        'DOGS':'BINANCE','DOLO':'BINANCE','DOOD':'BINANCE','DOT':'BINANCE','DRIFT':'KRAKEN',
        'DUSK':'BINANCE','DYDX':'BINANCE','DYM':'BINANCE','EDEN':'BINANCE','EDU':'BINANCE',
        'EGLD':'BINANCE','EIGEN':'BINANCE','ELSA':'BINANCE','ENA':'BINANCE','ENJ':'BINANCE',
        'ENS':'BINANCE','ENSO':'BINANCE','EPIC':'BINANCE','EPT':'MEXC','ERA':'BINANCE',
        'ESPORTS':'KRAKEN','ETC':'BINANCE','ETH':'BINANCE','ETHFI':'BINANCE','ETHW':'BINANCE',
        'EUL':'COINBASE','EVAA':'MEXC','F':'BINANCE','FARTCOIN':'MEXC','FET':'BINANCE',
        'FF':'BINANCE','FHE':'BYBIT','FIDA':'BINANCE','FIL':'BINANCE','FIO':'BINANCE',
        'FLOCK':'COINBASE','FLOKI':'BINANCE','FLOW':'BINANCE','FLR':'KRAKEN','FLUID':'OKX',
        'FOGO':'BINANCE','FOLKS':'BINANCE','FORM':'BINANCE','FORTH':'CAPITALCOM','FUN':'BINANCE',
        'G':'BINANCE','GALA':'BINANCE','GAS':'BINANCE','GHST':'COINBASE','GIGGLE':'BINANCE',
        'GLM':'OKX','GMT':'BINANCE','GMX':'BINANCE','GNO':'BINANCE','GOAT':'BINANCE',
        'GPS':'KUCOIN','GRASS':'BINANCE','GRIFFAIN':'BINANCE','GRT':'BINANCE','GT':'GATE',
        'GTC':'BINANCE','GUA':'GATE','GUN':'BINANCE','GWEI':'MEXC','H':'KRAKEN',
        'HAEDAL':'BINANCE','HANA':'BINANCE','HBAR':'BINANCE','HEI':'BINANCE','HEMI':'BINANCE',
        'HFT':'BINANCE','HIGH':'BINANCE','HIPPO':'BINANCE','HIVE':'BINANCE','HMSTR':'COINBASE',
        'HNT':'BYBIT','HOLO':'BINANCE','HOME':'COINBASE','HOOK':'BINANCE','HOT':'BINANCE',
        'HUMA':'BINANCE','HYPE':'BINANCE','HYPER':'COINBASE','ICNT':'BINANCE','ICP':'BINANCE',
        'ICX':'BINANCEUS','ID':'BINANCE','IDOL':'BINANCE','ILV':'BINANCE','IMX':'BINANCE',
        'IN':'BINANCE','INI':'MEXC','INIT':'KRAKEN','INJ':'BINANCE','INX':'COINBASE',
        'IO':'BINANCE','IOST':'BINANCE','IOTA':'BINANCE','IOTX':'BYBIT','IP':'COINBASE',
        'IR':'BINANCE','IRYS':'COINBASE','JASMY':'BINANCE','JCT':'BINANCE','JELLYJELLY':'OKX',
        'JOE':'BINANCE','JST':'BINANCE','JTO':'BINANCE','JUP':'BINANCE','KAIA':'BINANCE',
        'KAITO':'BINANCE','KAS':'MEXC','KAVA':'BINANCE','KERNEL':'BINANCE','KGEN':'BINANCE',
        'KITE':'BINANCE','KMNO':'BINANCE','KNC':'CAPITALCOM','KOMA':'MEXC','KSM':'BINANCE',
        'LA':'COINBASE','LAB':'BINGX','LAYER':'COINBASE','LDO':'COINBASE','LIGHT':'MEXC',
        'LINEA':'BINANCE','LINK':'BINANCE','LISTA':'BINANCE','LIT':'MEXC','LPT':'BINANCE',
        'LQTY':'BINANCE','LRC':'COINBASE','LSK':'BYBIT','LTC':'BYBIT','LUMIA':'BINANCE',
        'LUNA':'BYBIT','LUNA2':'KRAKEN','LUNC':'BINANCE','LYN':'KUCOIN','M':'MEXC',
        'MAGIC':'BINANCE','MAGMA':'BYBIT','MANA':'BINANCE','MANTA':'BINANCE','MASK':'BINANCE',
        'MAV':'BINANCE','MAVIA':'BINANCE','ME':'BINANCE','MELANIA':'BINANCE','MEME':'BINANCE',
        'MERL':'BINANCE','MET':'COINBASE','METIS':'COINBASE','MEW':'BYBIT','MINA':'KRAKEN',
        'MIRA':'BINANCE','MITO':'BINANCE','MLN':'BINANCE','MMT':'OKX','MNT':'BYBIT',
        'MOCA':'HTX','MOG':'BYBIT','MON':'COINBASE','MOODENG':'BINANCE','MORPHO':'OKX',
        'MOSS':'KCEX','MOVE':'KRAKEN','MOVR':'BINANCE','MTL':'BYBIT','MUBARAK':'BINANCE',
        'MYX':'BINANCE','NANO':'KRAKEN','NAORIS':'BYBIT','NEAR':'BINANCE','NEIRO':'BINANCE',
        'NEO':'BITFINEX','NEWT':'COINBASE','NEXO':'BINANCE','NFP':'BINANCE','NIGHT':'KRAKEN',
        'NIL':'COINBASE','NKN':'BINANCE','NMR':'BINANCE','NOM':'BINANCE','NOT':'BINANCE',
        'NPC':'BITGET','NTRN':'CRYPTOCOM','NXPC':'BINANCE','OG':'BINANCE','OGN':'KRAKEN',
        'OKB':'OKX','OL':'BINANCE','OM':'BINANCE','ON':'MEXC','ONDO':'BYBIT','ONE':'BINANCE',
        'ONG':'BINANCE','ONT':'BINANCE','OP':'BINANCE','OPEN':'KRAKEN','ORBS':'OKX',
        'ORCA':'BINANCE','ORDER':'KRAKEN','ORDI':'BINANCE','ORE':'MEXC','OXT':'BYBIT',
        'PARTI':'OKX','PEAQ':'GATE','PENDLE':'BINANCE','PENGU':'BINANCE','PENGUIN':'MEXC',
        'PEOPLE':'BINANCE','PEPE':'BINANCE','PHB':'BINANCE','PI':'OKX','PIEVERSE':'BYBIT',
        'PIPPIN':'BINANCE','PIXEL':'BINANCE','PLUME':'BYBIT','PNUT':'BINANCE','POL':'BINANCE',
        'POLYX':'BINANCE','POPCAT':'BYBIT','PORTAL':'BINANCE','POWER':'MEXC','POWR':'KRAKEN',
        'PROM':'BINANCE','PROMPT':'BYBIT','PROVE':'BINANCE','PTB':'BINANCE','PUFFER':'KRAKEN',
        'PUMP':'BINANCE','PUMPBTC':'BINANCE','PUNDIX':'BINANCE','PYTH':'BINANCE','Q':'KRAKEN',
        'QNT':'BINANCE','QTUM':'BINANCE','QUBIC':'GATE','RARE':'COINBASE','RATS':'HTX',
        'RAVE':'KRAKEN','RAY':'BINANCE','RDNT':'BINANCE','RECALL':'BINANCE','RED':'BINANCE',
        'RENDER':'BINANCE','REQ':'COINBASE','RESOLV':'BINANCE','REZ':'BINANCE','RIF':'BINANCE',
        'RIVER':'BINANCE','RLC':'KRAKEN','RLS':'COINBASE','RONIN':'COINBASE','ROSE':'BINANCE',
        'RPL':'BINANCE','RSC':'COINBASE','RSR':'BINANCE','RUNE':'BINANCE','RVN':'BINANCE',
        'RVV':'BINANCE','S':'BINANCE','SAFE':'COINBASE','SAGA':'BINANCE','SAHARA':'BINANCE',
        'SAND':'BINANCE','SAPIEN':'COINBASE','SC':'BINANCE','SCR':'OKX','SEI':'BINANCE',
        'SENT':'COINBASE','SFP':'BINANCE','SHELL':'BINANCE','SHIB':'COINBASE','SIGN':'BINANCE',
        'SIREN':'BINANCE','SKL':'BINANCE','SKR':'COINBASE','SKY':'BINANCE','SKYAI':'BINANCE',
        'SLP':'BINANCE','SNX':'BINANCE','SOL':'COINBASE','SOLV':'BINANCE','SOMI':'BINANCE',
        'SONIC':'BYBIT','SOON':'KRAKEN','SOPH':'OKX','SPACE':'BINANCE','SPELL':'COINBASE',
        'SPK':'BINANCE','SPORTFUN':'BINANCE','SPX':'MEXC','SQD':'BINANCE','SSV':'BINANCE',
        'STABLE':'BITGET','STBL':'BINANCE','STEEM':'BINANCE','STG':'BINANCE','STO':'BINANCE',
        'STORJ':'BINANCE','STRK':'BINANCE','STX':'BINANCE','SUI':'BINANCE','SUN':'BINANCE',
        'SUPER':'COINBASE','SUSHI':'BINANCE','SWARMS':'BINANCE','SXT':'BINANCE','SYN':'BINANCE',
        'SYRUP':'BINANCE','T':'BINANCE','TA':'BINANCE','TAC':'MEXC','TAG':'BINANCE',
        'TAIKO':'BINANCE','TAKE':'BITMART','TAO':'BINANCE','TEL':'BINGX','TFUEL':'MEXC',
        'THE':'BINANCE','THETA':'BINANCE','TIA':'COINBASE','TIBBIR':'LBANK','TLM':'BINANCE',
        'TNSR':'BINANCE','TON':'BINANCE','TOSHI':'COINBASE','TOWNS':'COINBASE','TRAC':'COINBASE',
        'TRADOOR':'BINANCE','TRB':'OKX','TREE':'BINANCE','TRIA':'COINBASE','TRU':'BINANCE',
        'TRUMP':'BINANCE','TRUST':'KRAKEN','TRUTH':'OKX','TRX':'BINANCE','TST':'BINANCE',
        'TURBO':'COINBASE','TURTLE':'BINANCE','TUT':'BINANCE','TWT':'BINANCE','UAI':'BINANCE',
        'UB':'BYBIT','ULTIMA':'HTX','UMA':'CAPITALCOM','UNI':'BINANCE','USELESS':'MEXC',
        'USTC':'BINANCE','USUAL':'BINANCE','US':'KRAKEN','VANA':'BINANCE','VANRY':'BINANCE',
        'VELO':'COINBASE','VELVET':'BINANCE','VET':'BINANCE','VFY':'BINANCE','VIC':'BINANCE',
        'VINE':'KRAKEN','VIRTUAL':'BINANCE','VTHO':'BINANCE','VVV':'COINBASE','W':'BINANCE',
        'WAL':'BINANCE','WAVES':'HTX','WAXP':'BINANCE','WCT':'BINANCE','WET':'BINANCE',
        'WHITEWHALE':'BYBIT','WIF':'BINANCE','WLD':'BINANCE','WLFI':'BINANCE','WMTX':'KRAKEN',
        'WOO':'BINANCE','XAI':'BYBIT','XAN':'KRAKEN','XAUT':'BITFINEX','XCH':'BYBIT',
        'XCN':'MEXC','XDC':'BITSTAMP','XEC':'MEXC','XLM':'BINANCE','XMR':'BYBIT',
        'XNO':'BINANCE','XNY':'BINANCE','XPIN':'BINANCE','XPL':'BINANCE','XPR':'MEXC',
        'XPT':'XTCOM','XRP':'BINANCE','XTZ':'BITFINEX','XVG':'BYBIT','XVS':'BINANCE',
        'YALA':'BINANCE','YB':'BYBIT','YFI':'BINANCE','YGG':'OKX','YZY':'BYBIT',
        'ZAMA':'BINANCE','ZBCN':'HTX','ZBT':'BINANCE','ZEC':'MEXC','ZEN':'BINANCE',
        'ZEREBRO':'BINANCE','ZETA':'BINANCE','ZIL':'BINANCE','ZK':'COINBASE','ZKC':'BINANCE',
        'ZKJ':'BINANCE','ZKP':'BINANCE','ZORA':'COINBASE','ZRO':'BINANCE','ZRX':'KRAKEN',
        'ZTC':'MEXC'
    };

    const DEFAULT_TV = ticker => {
        const sym = ticker.toUpperCase().replace(/USDT$|USD$|USDC$/,'');
        const exchange = TV_EXCHANGE_MAP[sym] || 'BINANCE';
        return `https://www.tradingview.com/chart/xF34dN3g/?symbol=${exchange}:${encodeURIComponent(sym)}USDT`;
    };
    const isAndroid = /Android/i.test(navigator.userAgent);
    const DEFAULT_BX = ticker => {
        const pair = ticker.toUpperCase().replace(/USDT$|USD$|USDC$/,'') + 'USDT';
        if (isAndroid) {
            return `https://www.unixcrypto.net/contract-trade/${pair}`;
        }
        return `https://www.bitunix.com/contract-trade/${pair}`;
    };

    function getTickerLinks() {
        try { return JSON.parse(localStorage.getItem('crypto_ticker_links') || '{}'); }
        catch { return {}; }
    }

    function saveTickerLinks(links) {
        localStorage.setItem('crypto_ticker_links', JSON.stringify(links));
    }

    function getTickerLink(ticker, platform) {
        const links = getTickerLinks();
        const key = ticker.toUpperCase();
        if (links[key] && links[key][platform]) return links[key][platform];
        return platform === 'tv' ? DEFAULT_TV(ticker) : DEFAULT_BX(ticker);
    }

    function copyTicker(ticker) {
        const pair = ticker.toUpperCase().replace(/USDT$|USD$|USDC$/,'') + 'USDT';
        navigator.clipboard.writeText(pair).then(() => {
            const btn = event.target;
            btn.textContent = '✓';
            setTimeout(() => btn.textContent = '📋', 1000);
        });
    }

    function editLinks(ticker) {
        const key = ticker.toUpperCase();
        const links = getTickerLinks();
        const current = links[key] || {};

        const tvUrl = prompt(
            `TradingView URL for ${key}:\n(Leave empty for default)`,
            current.tv || DEFAULT_TV(ticker)
        );
        if (tvUrl === null) return;

        const bxUrl = prompt(
            `Bitunix URL for ${key}:\n(Leave empty for default)`,
            current.bx || DEFAULT_BX(ticker)
        );
        if (bxUrl === null) return;

        if (!links[key]) links[key] = {};
        links[key].tv = tvUrl || '';
        links[key].bx = bxUrl || '';

        if (!links[key].tv) delete links[key].tv;
        if (!links[key].bx) delete links[key].bx;
        if (Object.keys(links[key]).length === 0) delete links[key];

        saveTickerLinks(links);
        renderTickerGrid();
    }

    // ====== API WRITE FUNCTIONS ======
    async function markAction(ticker, signal, price, value, elemId) {
        const sizeInput = document.getElementById(elemId + '-size');
        const entrySize = sizeInput ? sizeInput.value : '';
        const el = document.getElementById(elemId);

        el.querySelectorAll('.action-btn').forEach(b => b.disabled = true);

        try {
            await fetch(POST_URL, {
                method: 'POST',
                body: JSON.stringify({
                    action: 'update_position',
                    ticker: ticker,
                    signal: signal,
                    price: price,
                    field: 'action',
                    value: value,
                    entrySize: entrySize
                })
            });
            el.style.borderColor = value === 'Entered' ? 'var(--green-candle)' : 'var(--text-dim)';
            el.style.opacity = '0.5';
            el.innerHTML = '<div><span class="ticker-badge">' + esc(ticker) + '</span><span class="message">' + value.toUpperCase() + (entrySize ? ' ($' + entrySize + ')' : '') + '</span></div>';
            setTimeout(fetchData, 2000);
        } catch (err) {
            el.querySelectorAll('.action-btn').forEach(b => b.disabled = false);
            alert('Failed to update: ' + err.message);
        }
    }

    async function markOutcome(ticker, signal, price, value, elemId) {
        const profitInput = document.getElementById(elemId + '-profit');
        const profitLocked = profitInput ? profitInput.value : '';
        const el = document.getElementById(elemId);

        el.querySelectorAll('.action-btn').forEach(b => b.disabled = true);

        try {
            await fetch(POST_URL, {
                method: 'POST',
                body: JSON.stringify({
                    action: 'update_position',
                    ticker: ticker,
                    signal: signal,
                    price: price,
                    field: 'outcome',
                    value: value,
                    profitLocked: profitLocked
                })
            });
            const color = value === 'Won' ? 'var(--green-candle)' : value === 'Lost' ? 'var(--red-candle)' : 'var(--accent)';
            el.style.borderColor = color;
            el.style.opacity = '0.5';
            el.innerHTML = '<div><span class="ticker-badge">' + esc(ticker) + '</span><span class="message">' + value.toUpperCase() + (profitLocked ? ' ($' + profitLocked + ')' : '') + '</span></div>';
            setTimeout(fetchData, 2000);
        } catch (err) {
            el.querySelectorAll('.action-btn').forEach(b => b.disabled = false);
            alert('Failed to update: ' + err.message);
        }
    }

    async function markPickAction(ticker, signal, price, value, elemId) {
        const el = document.getElementById(elemId);
        el.querySelectorAll('.action-btn').forEach(b => b.disabled = true);

        try {
            await fetch(POST_URL, {
                method: 'POST',
                body: JSON.stringify({
                    action: 'update_position',
                    ticker: ticker,
                    signal: signal,
                    price: price,
                    field: 'action',
                    value: value
                })
            });
            const btns = el.querySelector('.top-pick-actions');
            btns.innerHTML = '<span style="font-size:0.7rem;color:' + (value === 'Entered' ? 'var(--green-bright)' : 'var(--text-dim)') + ';font-weight:700;letter-spacing:1px;text-transform:uppercase">' + value + '</span>';
            setTimeout(fetchData, 2000);
        } catch (err) {
            el.querySelectorAll('.action-btn').forEach(b => b.disabled = false);
            alert('Failed to update: ' + err.message);
        }
    }

    // ====== EMPTY FALLBACK ======
    const EMPTY_DATA = {
        status: 'ok',
        tickers: [
            { ticker:'BTCUSDT', totalTrades:12, wins:8, losses:4, winRate:'66.7%', lastSignal:'buy', lastPrice:'97500', avgRR:'2.1', openPositions:1 },
            { ticker:'ETHUSDT', totalTrades:9, wins:5, losses:4, winRate:'55.6%', lastSignal:'buy', lastPrice:'3400', avgRR:'1.8', openPositions:1 },
            { ticker:'SOLUSDT', totalTrades:15, wins:10, losses:5, winRate:'66.7%', lastSignal:'sell', lastPrice:'195', avgRR:'2.3', openPositions:0 },
            { ticker:'BNBUSDT', totalTrades:7, wins:4, losses:3, winRate:'57.1%', lastSignal:'buy', lastPrice:'650', avgRR:'1.6', openPositions:0 },
            { ticker:'XRPUSDT', totalTrades:11, wins:7, losses:4, winRate:'63.6%', lastSignal:'buy', lastPrice:'2.45', avgRR:'2.0', openPositions:1 },
            { ticker:'ADAUSDT', totalTrades:6, wins:3, losses:3, winRate:'50.0%', lastSignal:'buy', lastPrice:'0.72', avgRR:'1.5', openPositions:0 },
            { ticker:'DOGEUSDT', totalTrades:8, wins:5, losses:3, winRate:'62.5%', lastSignal:'sell', lastPrice:'0.32', avgRR:'1.9', openPositions:0 },
            { ticker:'AVAXUSDT', totalTrades:10, wins:6, losses:4, winRate:'60.0%', lastSignal:'buy', lastPrice:'38', avgRR:'1.7', openPositions:0 },
            { ticker:'DOTUSDT', totalTrades:5, wins:2, losses:3, winRate:'40.0%', lastSignal:'buy', lastPrice:'7.20', avgRR:'1.4', openPositions:0 },
            { ticker:'LINKUSDT', totalTrades:8, wins:6, losses:2, winRate:'75.0%', lastSignal:'buy', lastPrice:'18.50', avgRR:'2.2', openPositions:1 },
            { ticker:'SUIUSDT', totalTrades:14, wins:10, losses:4, winRate:'71.4%', lastSignal:'buy', lastPrice:'4.20', avgRR:'2.5', openPositions:1 },
            { ticker:'PEPEUSDT', totalTrades:6, wins:4, losses:2, winRate:'66.7%', lastSignal:'buy', lastPrice:'0.0000125', avgRR:'2.8', openPositions:0 },
            { ticker:'ARBUSDT', totalTrades:9, wins:5, losses:4, winRate:'55.6%', lastSignal:'sell', lastPrice:'1.05', avgRR:'1.9', openPositions:0 },
            { ticker:'OPUSDT', totalTrades:11, wins:8, losses:3, winRate:'72.7%', lastSignal:'buy', lastPrice:'1.85', avgRR:'2.1', openPositions:0 },
            { ticker:'NEARUSDT', totalTrades:7, wins:5, losses:2, winRate:'71.4%', lastSignal:'buy', lastPrice:'5.50', avgRR:'2.4', openPositions:0 }
        ],
        recentSignals: [
            { timestamp:'2026-02-06 20:30', symbol:'SUIUSDT', signal:'buy', entry:'4.20', sl:'3.80', tp1:'5.00', tp2:'5.80', macd:'rising', volume:'above', cross:'2', in_zone:'true', rsi:'58', timeframe:'4h', score:6 },
            { timestamp:'2026-02-06 20:15', symbol:'PEPEUSDT', signal:'buy', entry:'0.0000125', sl:'0.0000110', tp1:'0.0000150', tp2:'0.0000180', macd:'rising', volume:'above', cross:'1', in_zone:'true', rsi:'62', timeframe:'1h', score:6 },
            { timestamp:'2026-02-06 20:00', symbol:'ARBUSDT', signal:'sell', entry:'1.05', sl:'1.15', tp1:'0.88', tp2:'0.75', macd:'falling', volume:'above', cross:'3', in_zone:'true', rsi:'35', timeframe:'4h', score:6 },
            { timestamp:'2026-02-06 19:45', symbol:'OPUSDT', signal:'buy', entry:'1.85', sl:'1.65', tp1:'2.20', tp2:'2.60', macd:'rising', volume:'above', cross:'4', in_zone:'true', rsi:'55', timeframe:'4h', score:6 },
            { timestamp:'2026-02-06 19:30', symbol:'NEARUSDT', signal:'buy', entry:'5.50', sl:'4.90', tp1:'6.50', tp2:'7.50', macd:'rising', volume:'above', cross:'2', in_zone:'true', rsi:'60', timeframe:'1h', score:6 },
            { timestamp:'2026-02-06 19:00', symbol:'BTCUSDT', signal:'buy', entry:'97500', sl:'95000', tp1:'102000', tp2:'108000', macd:'rising', volume:'below', cross:'12', in_zone:'false', rsi:'55', timeframe:'4h', score:2 },
            { timestamp:'2026-02-06 18:45', symbol:'ETHUSDT', signal:'buy', entry:'3400', sl:'3200', tp1:'3700', tp2:'4000', macd:'flat', volume:'above', cross:'8', in_zone:'false', rsi:'48', timeframe:'4h', score:1 },
            { timestamp:'2026-02-06 18:30', symbol:'SOLUSDT', signal:'sell', entry:'195', sl:'210', tp1:'175', tp2:'160', macd:'falling', volume:'below', cross:'15', in_zone:'false', rsi:'62', timeframe:'1h', score:2 },
            { timestamp:'2026-02-06 18:15', symbol:'BNBUSDT', signal:'buy', entry:'650', sl:'620', tp1:'700', tp2:'750', macd:'flat', volume:'below', cross:'20', in_zone:'false', rsi:'50', timeframe:'4h', score:0 },
            { timestamp:'2026-02-06 18:00', symbol:'XRPUSDT', signal:'buy', entry:'2.45', sl:'2.20', tp1:'2.80', tp2:'3.10', macd:'rising', volume:'below', cross:'9', in_zone:'false', rsi:'52', timeframe:'1h', score:2 },
            { timestamp:'2026-02-06 17:45', symbol:'ADAUSDT', signal:'buy', entry:'0.72', sl:'0.65', tp1:'0.85', tp2:'0.95', macd:'flat', volume:'below', cross:'18', in_zone:'false', rsi:'45', timeframe:'4h', score:0 },
            { timestamp:'2026-02-06 17:30', symbol:'DOGEUSDT', signal:'sell', entry:'0.32', sl:'0.36', tp1:'0.26', tp2:'0.22', macd:'falling', volume:'below', cross:'14', in_zone:'false', rsi:'58', timeframe:'1h', score:2 },
            { timestamp:'2026-02-06 17:00', symbol:'AVAXUSDT', signal:'buy', entry:'38', sl:'34', tp1:'44', tp2:'50', macd:'rising', volume:'below', cross:'11', in_zone:'false', rsi:'47', timeframe:'4h', score:2 },
            { timestamp:'2026-02-06 16:45', symbol:'DOTUSDT', signal:'buy', entry:'7.20', sl:'6.50', tp1:'8.50', tp2:'9.50', macd:'flat', volume:'below', cross:'16', in_zone:'false', rsi:'43', timeframe:'4h', score:0 },
            { timestamp:'2026-02-06 16:30', symbol:'LINKUSDT', signal:'buy', entry:'18.50', sl:'16.80', tp1:'21.00', tp2:'24.00', macd:'rising', volume:'below', cross:'10', in_zone:'false', rsi:'51', timeframe:'1h', score:2 }
        ],
        actionNeeded: [
            { type:'mark_action', timestamp:'2026-02-06 20:30', symbol:'SUIUSDT', signal:'buy', entry:'4.20', sl:'3.80', tp1:'5.00', score:6, row:2 },
            { type:'mark_action', timestamp:'2026-02-06 20:15', symbol:'PEPEUSDT', signal:'buy', entry:'0.0000125', sl:'0.0000110', tp1:'0.0000150', score:6, row:3 },
            { type:'mark_action', timestamp:'2026-02-06 20:00', symbol:'ARBUSDT', signal:'sell', entry:'1.05', sl:'1.15', tp1:'0.88', score:6, row:4 },
            { type:'mark_action', timestamp:'2026-02-06 19:45', symbol:'OPUSDT', signal:'buy', entry:'1.85', sl:'1.65', tp1:'2.20', score:6, row:5 },
            { type:'mark_action', timestamp:'2026-02-06 19:30', symbol:'NEARUSDT', signal:'buy', entry:'5.50', sl:'4.90', tp1:'6.50', score:6, row:6 }
        ],
        stats: {
            totalTrades: 136, wins: 85, losses: 51, winRate: '62.5%',
            openPositions: 4, todaySignals: 15, bestWinStreak: 7,
            worstLossStreak: 3, currentStreak: 'W3',
            bestTicker: 'LINKUSDT', worstTicker: 'DOTUSDT',
            winRateByScore: { high: '78%', mid: '55%', low: '42%' }
        }
    };

    // ====== QUOTES ======
    const QUOTES = [
        { text: "The trend is your friend until the end when it bends.", author: "Ed Seykota" },
        { text: "In crypto, the impossible happens about twice a week.", author: "Crypto Wisdom" },
        { text: "Not your keys, not your coins. Not your plan, not your profits.", author: "Crypto Proverb" },
        { text: "The market is never wrong -- opinions often are.", author: "Jesse Livermore" },
        { text: "Cut your losses short and let your profits run.", author: "Jesse Livermore" },
        { text: "Plan your trade and trade your plan.", author: "Richard Dennis" },
        { text: "Risk comes from not knowing what you are doing.", author: "Warren Buffett" },
        { text: "The goal of a successful trader is to make the best trades. Money is secondary.", author: "Alexander Elder" },
        { text: "Markets can remain irrational longer than you can remain solvent.", author: "John Maynard Keynes" },
        { text: "Amateurs think about how much money they can make. Professionals think about how much money they could lose.", author: "Jack Schwager" },
        { text: "You don't need to know what is going to happen next in order to make money.", author: "Mark Douglas" },
        { text: "Every battle is won before it is fought.", author: "Sun Tzu" },
        { text: "There is a time to go long, a time to go short, and a time to go fishing.", author: "Jesse Livermore" },
        { text: "Discipline is the bridge between goals and accomplishment.", author: "Jim Rohn" },
        { text: "The elements of good trading are: cutting losses, cutting losses, and cutting losses.", author: "Ed Seykota" },
        { text: "Do not anticipate and move without market confirmation.", author: "Jesse Livermore" },
        { text: "The best time to buy crypto was yesterday. The second best time is after your signal fires.", author: "Crypto Wisdom" },
        { text: "A 100x means nothing if you can't manage a 2x.", author: "Crypto Proverb" },
        { text: "Patience is not the ability to wait, but the ability to keep a good attitude while waiting.", author: "Joyce Meyer" },
        { text: "The hard work in trading comes in the preparation. The actual process of trading should be effortless.", author: "Jack Schwager" }
    ];

    function showQuote() {
        const q = QUOTES[Math.floor(Math.random() * QUOTES.length)];
        const textEl = document.getElementById('quoteText');
        const authEl = document.getElementById('quoteAuthor');
        textEl.style.opacity = '0';
        authEl.style.opacity = '0';
        setTimeout(() => {
            textEl.textContent = '"' + q.text + '"';
            authEl.textContent = '-- ' + q.author;
            textEl.style.opacity = '0.7';
            authEl.style.opacity = '0.6';
        }, 300);
    }
    showQuote();

    // ====== INIT ======
    fetchData();

    // ====== SERVICE WORKER ======
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./service-worker.js');
    }
</script>

</body>
</html>
